<script src="data2.js"></script>
<script>
// done = true;
// data = JSON.stringify({times: times, levels: levels})
console.log(data.times.length);


var fps = 25;
var totalFrames = fps * 77;
var t ;


var results = [];
for (var i=0;i<totalFrames;i++) {
	t = i/fps;
	result = getLevels(t);
	results.push(result)
	
	
}

console.log('results', results);


function findTime(targetTime) {
	// binary search for the index with largest value smaller than target u distance
	var i ;
	var il = data.times.length;
	var low = 0, high = il - 1, comparison;
	

	while ( low <= high ) {

		i = Math.floor( low + ( high - low ) / 2 ); // less likely to overflow, though probably not issue here, JS doesn't really have integers, all numbers are floats

	  	comparison = data.times[ i ] - targetTime;

	  	if ( comparison < 0 ) {

			low = i + 1;
			continue;

		} else if ( comparison > 0 ) {

			high = i - 1;
			continue;

		} else {

			high = i;
			break;

			// DONE

		}

	}


	return high;
	// console.log('high', high, low);
	
	
}

function getLevels(targetTime) {
	var index = findTime(targetTime);
	
	if (index<0) {
		return data.levels[0];
	}
	
	var time1 = data.times[index];
	var time2 = data.times[index + 1];
	
	var level1 = data.levels[index];
	var level2 = data.levels[index + 1];
	
	if (targetTime == time1) {
		return level1;
	}
	
	var timeDiff = time2 - time1;
	var lapsed =  targetTime - time1;
	var levelDiff = level2 - level1;
	
	return lapsed/timeDiff * levelDiff + level1;
	
	
	
}

// var ()

</script>